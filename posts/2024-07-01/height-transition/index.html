<!DOCTYPE html>
<html lang="ja" data-astro-cid-sckkx6r4>

<head>
  <link rel="icon" type="image/vnd.microsoft.icon" href="/favicon.ico">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="google-adsense-account" content="ca-pub-1276308583388146">
  <meta name="author" content="ダーシノ(B.C.Rikko)">
  <meta name="description" content="通常height:0→autoのトランジションはできないが、calc-size()が実装されたら使えるようになる">
  <meta name="keywords" content="HTML,CSS">
  <meta name="generator" content="Astro">
  <meta name="theme-color" content="#fafafa">
  <meta name="color-scheme" content="only light">
  <meta property="og:type" content="article">
  <meta property="og:title" content="height:0→autoをトランジションする | ダーシノ(B.C.Rikko)">
  <meta property="og:description" content="通常height:0→autoのトランジションはできないが、calc-size()が実装されたら使えるようになる">
  <meta property="og:image" content="https://bcrikko.github.io/bcrikko.png">
  <meta property="og:url" content="https://bcrikko.github.io/posts/2024-07-01/height-transition/">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap" rel="stylesheet">
  <title>height:0→autoをトランジションする</title>
  <style>
    .tags[data-astro-cid-3ef6ksr2] {
      font-size: .8rem;
      display: flex;
      flex-wrap: wrap;
      gap: 2em;

      >div {
        display: flex;
        gap: .5em
      }

      dt:after {
        content: ":"
      }

      dd {
        margin: 0
      }
    }

    .panel {
      height: 0;
      overflow: hidden;
      transition: height .3s;
      background-color: #eee;

      &.expanded {
        height: calc-size(auto)
      }
    }

    html {
      font-family: Noto Sans JP, sans-serif;
      font-size: 1.25rem;
      line-height: 1.7;
      letter-spacing: .05em;
      color: #333;
      background-color: #fafafa
    }

    :where(header, footer, main) {
      max-width: 40ic;
      margin-inline: auto
    }

    p {
      word-break: auto-phrase
    }

    dt {
      font-weight: 800
    }

    pre {
      padding: 1em;
      font-size: .8rem;
      line-height: 1.4
    }

    code {
      font-style: italic;
      padding: 0 .2em;
      background-color: #eee
    }

    pre>code {
      font-family: Menlo, Monaco, Courier New, monospace;
      font-style: initial;
      padding: initial;
      background-color: initial
    }

    blockquote {
      margin: 2em 0;
      padding: .2em 1em;
      border-left: 8px solid #CACACA;
      background-color: #eee
    }

    a {
      word-break: break-word
    }

    table {
      width: 100%;
      overflow-x: auto
    }

    tr:nth-child(2n) {
      background-color: #eee
    }

    header[data-astro-cid-sckkx6r4] {
      display: flex;
      justify-content: space-between
    }

    footer[data-astro-cid-sckkx6r4] {
      text-align: center
    }
  </style>
</head>

<body data-astro-cid-sckkx6r4>
  <header data-astro-cid-sckkx6r4> <a href="https://bcrikko.github.io/" data-astro-cid-sckkx6r4>≪ Today I learned.</a>
    <a href="/rss" target="_blank" aria-label="RSSフィードを購読する" data-astro-cid-sckkx6r4>
      RSS購読
    </a> </header>
  <main data-astro-cid-sckkx6r4>
    <hgroup data-astro-cid-3ef6ksr2>
      <dl class="tags" data-astro-cid-3ef6ksr2>
        <div data-astro-cid-3ef6ksr2>
          <dt data-astro-cid-3ef6ksr2>公開日</dt>
          <dd data-astro-cid-3ef6ksr2><time data-astro-cid-3ef6ksr2>2024-07-01</time></dd>
        </div>
        <div data-astro-cid-3ef6ksr2>
          <dt data-astro-cid-3ef6ksr2>更新日</dt>
          <dd data-astro-cid-3ef6ksr2> <time data-astro-cid-3ef6ksr2>2024-07-11</time> </dd>
        </div>
        <div data-astro-cid-3ef6ksr2>
          <dt data-astro-cid-3ef6ksr2>タグ</dt>
          <dd data-astro-cid-3ef6ksr2>HTML, CSS</dd>
        </div>
        <div data-astro-cid-3ef6ksr2>
          <dt data-astro-cid-3ef6ksr2>著者</dt>
          <dd data-astro-cid-3ef6ksr2> <a href="/aboutme" data-astro-cid-3ef6ksr2>
              ダーシノ(@bc_rikko)
            </a><a data-astro-cid-3ef6ksr2></a></dd><a data-astro-cid-3ef6ksr2></a>
        </div><a data-astro-cid-3ef6ksr2></a>
      </dl><a data-astro-cid-3ef6ksr2>
        <h1 data-astro-cid-3ef6ksr2>height:0→autoをトランジションする</h1>
      </a>
    </hgroup>
    <p>
      通常、<code>height: 0</code>から<code>height: auto</code>へのトランジションはできない。<code>height:300px</code>のように固定高にすればトランジションできるが、内包するコンテンツによってはバグることがある。
    </p>
    <p><a
        href="https://chromestatus.com/feature/5196713071738880">calc-size()</a>を使って<code>height: calc-size(auto);</code>とすると、内包するコンテンツの高さにあわせてトランジションできる。（※2024-07-01現在、Chrome
      Canaryでのみ実行可能）</p>
    <pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0"
      data-language="html"><code><span class="line"><span style="color:#E1E4E8">&lt;</span><span style="color:#85E89D">button</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;open&quot;</span><span style="color:#E1E4E8">&gt;Open&lt;/</span><span style="color:#85E89D">button</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">&lt;</span><span style="color:#85E89D">section</span><span style="color:#B392F0"> class</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;panel&quot;</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">  &lt;</span><span style="color:#85E89D">p</span><span style="color:#E1E4E8">&gt;Content&lt;/</span><span style="color:#85E89D">p</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">&lt;/</span><span style="color:#85E89D">section</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"></span></code></pre>
    <pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0"
      data-language="js"><code><span class="line"><span style="color:#E1E4E8">document.</span><span style="color:#B392F0">getElementById</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;open&#39;</span><span style="color:#E1E4E8">).</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;click&#39;</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  document.</span><span style="color:#B392F0">querySelector</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;.panel&#39;</span><span style="color:#E1E4E8">).classList.</span><span style="color:#B392F0">toggle</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;expanded&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">})</span></span>
<span class="line"></span></code></pre>
    <pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0"
      data-language="css"><code><span class="line"><span style="color:#B392F0">.panel</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">  height</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">  overflow</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">hidden</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">  transition</span><span style="color:#E1E4E8">: height </span><span style="color:#79B8FF">0.3</span><span style="color:#F97583">s</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &amp;.</span><span style="color:#79B8FF">expanded</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    /* トランジションしない */</span></span>
<span class="line"><span style="color:#79B8FF">    height</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">auto</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    /* トランジションするけど固定高で、内包するコンテンツによってはバグる*/</span></span>
<span class="line"><span style="color:#79B8FF">    height</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">300</span><span style="color:#F97583">px</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    /* トランジションする!!!!! */</span></span>
<span class="line"><span style="color:#79B8FF">    height</span><span style="color:#E1E4E8">: calc-size(</span><span style="color:#79B8FF">auto</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
    <hr />
    <h2 id="サンプル">サンプル</h2>
    <p>※2024-07-01現在、Chrome Canaryでのみ実行可能</p>
    <button id="open">Open</button>
    <section class="panel">
      <p>Content</p>
    </section>
    <script>
      document.getElementById('open').addEventListener('click', () => {
        document.querySelector('.panel').classList.toggle('expanded')
      })
    </script>
    <hr />
    <h2 id="calc-sizeが使えるようになるまでの対応"><code>calc-size()</code>が使えるようになるまでの対応</h2>
    <p><code>max-height</code>を使うことで<code>calc-size(auto)</code>と同じような効果が得られる。ただし、若干hackyになるので注意。</p>
    <pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0"
      data-language="css"><code><span class="line"><span style="color:#B392F0">.expand</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">  transition</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">all</span><span style="color:#79B8FF"> 0.2</span><span style="color:#F97583">s</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">  height</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">auto</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">  overflow</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">hidden</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &amp;[</span><span style="color:#79B8FF">aria-hidden</span><span style="color:#E1E4E8">=&quot;</span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">&quot;] {</span></span>
<span class="line"><span style="color:#79B8FF">    max-height</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">  &amp;[</span><span style="color:#B392F0">aria-hidden</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&quot;false&quot;</span><span style="color:#E1E4E8">] {</span></span>
<span class="line"><span style="color:#79B8FF">    max-height</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">100</span><span style="color:#F97583">vh</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">    visibility</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">hidden</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
  </main>
  <footer data-astro-cid-sckkx6r4>
    <p data-astro-cid-sckkx6r4> <small data-astro-cid-sckkx6r4>
        Copyright © 2024 <a href="https://x.com/bc_rikko" target="_blank" data-astro-cid-sckkx6r4>
          ダーシノ(@bc_rikko)
        </a> </small> </p>
  </footer>
</body>

</html>